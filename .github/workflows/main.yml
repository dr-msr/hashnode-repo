name: Post MD To Wordpress

on:
  push:
    branches:
      - main  

jobs:
  job_extract_md_file_content:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      - id: files
        uses: jitterbit/get-changed-files@v1
      - run: |
         for changed_file in ${{ steps.files.outputs.added }}; do
         echo "Do something with this ${changed_file}."
         subject=$(grep "title" ${changed_file} | sed 's/title: //' | sed 's/"//' | sed 's/"//')
         content=$(sed '/---/,/---/d' ${changed_file} )
         echo "${subject}"
         echo "${content}"
         done
      - name: Send mail
        uses: dawidd6/action-send-mail@v3
        with:
         server_address: smtp.gmail.com
         server_port: 465
         secure: true
         username: ${{secrets.MAIL_USERNAME}}
         password: ${{secrets.MAIL_PASSWORD}}
         subject: ${subject}
         to: ${{secrets.ADDRESS_WP}}
         from: drmsr-github 
         body: ${content}
 

